(this["webpackJsonpmigration-portal"]=this["webpackJsonpmigration-portal"]||[]).push([[0],{23:function(e,t,n){e.exports={content:"App_content__3geu6"}},27:function(e,t,n){e.exports=n(55)},53:function(e,t,n){},55:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(20),o=n.n(s),c=n(8),i="gpconnect-demonstrator",u=function(){return r.a.createElement("header",{className:"nhsuk-header nhsuk-header--transactional",role:"banner","data-testid":"header"},r.a.createElement("div",{className:"nhsuk-width-container nhsuk-header__container"},r.a.createElement("div",{className:"nhsuk-header__logo"},r.a.createElement(c.b,{className:"nhsuk-header__link",to:"/".concat(i),"aria-label":"NHS homepage"},r.a.createElement("svg",{className:"nhsuk-logo nhsuk-logo--white",xmlns:"http://www.w3.org/2000/svg",focusable:"false",viewBox:"0 0 40 16"},r.a.createElement("path",{fill:"#fff",d:"M0 0h40v16H0z"}),r.a.createElement("path",{fill:"#005eb8",d:"M3.9 1.5h4.4l2.6 9h.1l1.8-9h3.3l-2.8 13H9l-2.7-9h-.1l-1.8 9H1.1M17.3 1.5h3.6l-1 4.9h4L25 1.5h3.5l-2.7 13h-3.5l1.1-5.6h-4.1l-1.2 5.6h-3.4M37.7 4.4c-.7-.3-1.6-.6-2.9-.6-1.4 0-2.5.2-2.5 1.3 0 1.8 5.1 1.2 5.1 5.1 0 3.6-3.3 4.5-6.4 4.5-1.3 0-2.9-.3-4-.7l.8-2.7c.7.4 2.1.7 3.2.7s2.8-.2 2.8-1.5c0-2.1-5.1-1.3-5.1-5 0-3.4 2.9-4.4 5.8-4.4 1.6 0 3.1.2 4 .6"}),r.a.createElement("img",{alt:"nhs-logo",src:"https://assets.nhs.uk/images/nhs-logo.png"})))),r.a.createElement("div",{className:"nhsuk-header__transactional-service-name"},r.a.createElement("a",{className:"nhsuk-header__transactional-service-name--link",href:"/"},"Appointments Migrator"))))},l=n(23),p=n.n(l),d=n(24),h=n(7),m=n(1),f=n.n(m),g=n(9),v=function(e){var t=e.items,n=e.icon,a=void 0!==n&&n,s=e.success,o=void 0===s||s;return r.a.createElement("ul",{className:"list-reset"},r.a.createElement("div",{className:"mb4"},function(e){return e.map((function(e){var t=e.practitioner,n=e.location,s=e.start,c=e.end,i=e.description,u=e.patientId,l=e.schedule;return r.a.createElement("li",{className:"mb4"},r.a.createElement("div",null,r.a.createElement("hr",null),a&&function(e){return{true:r.a.createElement("svg",{className:"right nhsuk-icon nhsuk-icon__tick",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true"},r.a.createElement("path",{"stroke-width":"4","stroke-linecap":"round",d:"M18.4 7.8l-8.5 8.4L5.6 12"})),false:r.a.createElement("svg",{className:"right nhsuk-icon nhsuk-icon__cross",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24","aria-hidden":"true"},r.a.createElement("path",{d:"M17 18.5c-.4 0-.8-.1-1.1-.4l-10-10c-.6-.6-.6-1.6 0-2.1.6-.6 1.5-.6 2.1 0l10 10c.6.6.6 1.5 0 2.1-.3.3-.6.4-1 .4z"}),r.a.createElement("path",{d:"M7 18.5c-.4 0-.8-.1-1.1-.4-.6-.6-.6-1.5 0-2.1l10-10c.6-.6 1.5-.6 2.1 0 .6.6.6 1.5 0 2.1l-10 10c-.3.3-.6.4-1 .4z"}))}[e.toString()]}(o),r.a.createElement("h4",null,u),r.a.createElement("ul",null,r.a.createElement("li",null,s," \u27a1 ",c),r.a.createElement("li",null,t),r.a.createElement("li",null,n),r.a.createElement("li",null,l)),r.a.createElement("div",null,i)))}))}(t)))},w=n(11),b=n(6),E="gpconnect",T="none",y={api:T},S=function(){return y.api},k={accept:"application/fhir+json","Ssp-TraceID":"09a01679-2564-0fb4-5129-aecc81ea2706","Ssp-From":200000000359,"Ssp-To":918999198993,"Ssp-InteractionID":"urn:nhs:names:services:gpconnect:fhir:rest:search:slot-1"},x="http://localhost:9000/gpconnect-demonstrator/v1/fhir",D=n(25),I=n.n(D),N=function(){var e=new Date,t=new Date(e.getTime()+3e5),n=Math.round(e.getTime()/1e3),a={iss:"http://gpconnect-postman-url",sub:"1",aud:"providerURL_1_x_x",exp:Math.round(t.getTime()/1e3),iat:n,reason_for_request:"directcare",requested_scope:"patient/*.read",requesting_device:{resourceType:"Device",id:"1",identifier:[{system:"Web Interface",value:"Postman example consumer"}],model:"Postman",version:"1.0"},requesting_organization:{resourceType:"Organization",identifier:[{system:"https://fhir.nhs.uk/Id/ods-organization-code",value:"requesting_organization_ODS_Code"}],name:"Postman Organization"},requesting_practitioner:{resourceType:"Practitioner",id:"1",identifier:[{system:"https://fhir.nhs.uk/Id/sds-user-id",value:"G13579135"},{system:"https://fhir.nhs.uk/Id/sds-role-profile-id",value:"111111111"}],name:[{family:"Demonstrator",given:["GPConnect"],prefix:["Mr"]}]}},r=I()(JSON.stringify(a));return"eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.".concat(r,".")},_=function(e){return e.entry.map((function(e){return e.resource})).sort((function(e,t){return Number(e.id)-Number(t.id)})).map((function(e){e.id;var t=e.description,n=e.start,a=e.end,r=e.minutesDuration,s=e.slot,o=e.participant;return[[o[0].actor.reference],[s[0].reference],[o[1].actor.reference],[o[2].actor.reference],[n,"start"],[a,"end"],[r,"duration"],[t,"description"]]}))},A=n(26),O=function(e){return e.map((function(e){var t=e.start,n=e.end,a=Object(A.a)(e,["start","end"]);return Object(w.a)({start:new Date(t).toLocaleString(),end:new Date(n).toLocaleString().split(",")[1]},a)}))},G=[{description:"A appointment to discuss test data.",start:"2020-02-13T09:00:00+00:00",end:"2020-02-13T09:10:00+00:00",minutesDuration:10,schedule:"Schedule 12 for phone appointments with staff nurse",patientId:"Laura Barry",location:"The Hepworth Surgery",practitioner:"Nichole Gilbert (G13579135)"},{description:"A follow-up appointment for tests.",start:"2020-02-13T09:00:00+00:00",end:"2020-02-13T09:10:00+00:00",minutesDuration:10,schedule:"Schedule 9 for general appointments",patientId:"Les Fawcett",location:"The Hockey Surgery Annex",practitioner:"Dr Melissa Parsons (G11111116)"},{description:"A appointment to discuss test data.",start:"2020-02-13T09:00:00+00:00",end:"2020-02-13T09:10:00+00:00",minutesDuration:10,schedule:"Schedule 12 for phone appointments with staff nurse",patientId:"Emily Margo",location:"The Hepworth Surgery",practitioner:"Nichole Gilbert (G13579135)"},{description:"A follow-up appointment for tests.",start:"2020-02-13T09:00:00+00:00",end:"2020-02-13T09:10:00+00:00",minutesDuration:10,schedule:"Schedule 9 for general appointments",patientId:"Parth Aggarwal",location:"The Hockey Surgery Annex",practitioner:"Dr Melissa Parsons (G11111116)"},{description:"A appointment to discuss test data.",start:"2020-02-13T09:00:00+00:00",end:"2020-02-13T09:10:00+00:00",minutesDuration:10,schedule:"Schedule 12 for phone appointments with staff nurse",patientId:"Natasha Desai",location:"The Hepworth Surgery",practitioner:"Nichole Gilbert (G13579135)"},{description:"A follow-up appointment for tests.",start:"2020-02-13T09:00:00+00:00",end:"2020-02-13T09:10:00+00:00",minutesDuration:10,schedule:"Schedule 9 for general appointments",patientId:"Tina Coxhead",location:"The Hockey Surgery Annex",practitioner:"Dr Melissa Parsons (G11111116)"}],M=[{success:!1,errorMessage:"",description:"A appointment to discuss test data.",start:"2020-02-13T09:00:00+00:00",end:"2020-02-13T09:10:00+00:00",minutesDuration:10,schedule:"Schedule 12 for phone appointments with staff nurse",patientId:"Laura Barry",location:"The Hepworth Surgery",practitioner:"Nichole Gilbert (G13579135)"},{success:!1,errorMessage:"",description:"A follow-up appointment for tests.",start:"2020-02-13T09:00:00+00:00",end:"2020-02-13T09:10:00+00:00",minutesDuration:10,schedule:"Schedule 9 for general appointments",patientId:"Les Fawcett",location:"The Hockey Surgery Annex",practitioner:"Dr Melissa Parsons (G11111116)"},{success:!0,errorMessage:"",description:"A appointment to discuss test data.",start:"2020-02-13T09:00:00+00:00",end:"2020-02-13T09:10:00+00:00",minutesDuration:10,schedule:"Schedule 12 for phone appointments with staff nurse",patientId:"Emily Margo",location:"The Hepworth Surgery",practitioner:"Nichole Gilbert (G13579135)"},{success:!0,errorMessage:"",description:"A follow-up appointment for tests.",start:"2020-02-13T09:00:00+00:00",end:"2020-02-13T09:10:00+00:00",minutesDuration:10,schedule:"Schedule 9 for general appointments",patientId:"Parth Aggarwal",location:"The Hockey Surgery Annex",practitioner:"Dr Melissa Parsons (G11111116)"},{success:!0,errorMessage:"",description:"A appointment to discuss test data.",start:"2020-02-13T09:00:00+00:00",end:"2020-02-13T09:10:00+00:00",minutesDuration:10,schedule:"Schedule 12 for phone appointments with staff nurse",patientId:"Natasha Desai",location:"The Hepworth Surgery",practitioner:"Nichole Gilbert (G13579135)"},{success:!0,errorMessage:"",description:"A follow-up appointment for tests.",start:"2020-02-13T09:00:00+00:00",end:"2020-02-13T09:10:00+00:00",minutesDuration:10,schedule:"Schedule 9 for general appointments",patientId:"Tina Coxhead",location:"The Hockey Surgery Annex",practitioner:"Dr Melissa Parsons (G11111116)"}],j=function(e){var t,n,a,r,s,o,c,i;return f.a.async((function(u){for(;;)switch(u.prev=u.next){case 0:return t=e.url,n=e.headers,a=void 0===n?{}:n,r=e.method,s=void 0===r?"GET":r,o=e.body,c=void 0===o?"":o,u.next=3,f.a.awrap(fetch(t,{headers:a,method:s,body:c}).catch((function(e){console.log("error",e)})));case 3:if(!(i=u.sent)){u.next=8;break}return u.next=7,f.a.awrap(i.json());case 7:return u.abrupt("return",u.sent);case 8:return u.abrupt("return",[]);case 9:case"end":return u.stop()}}))},P=function(){var e,t;return f.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return e={},Object(b.a)(e,E,H),Object(b.a)(e,T,z),t=e,n.next=3,f.a.awrap(t[S()]());case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}}))},H=function(){var e,t,n,a,r,s,o,c,i,u,l,p=arguments;return f.a.async((function(d){for(;;)switch(d.prev=d.next){case 0:return e=p.length>0&&void 0!==p[0]?p[0]:{start:"2020-02-13T09:40:00+00:00",end:"2020-02-13T09:50:00+00:00",slotId:"115",patientId:"2",locationId:"17"},t=e.start,n=e.end,a=e.slotId,r=e.patientId,s=e.locationId,o=JSON.stringify({resourceType:"Appointment",meta:{profile:["https://fhir.nhs.uk/STU3/StructureDefinition/GPConnect-Appointment-1"]},contained:[{resourceType:"Organization",id:"1",meta:{profile:["https://fhir.nhs.uk/STU3/StructureDefinition/CareConnect-GPC-Organization-1"]},identifier:[{system:"https://fhir.nhs.uk/Id/ods-organization-code",value:"GPC001"}],name:"GP Connect Demonstrator",telecom:[{system:"phone",value:"0113 258 2569"}]}],status:"booked",created:"2020-02-11T09:40:00+00:00",description:"A test appointment booked from Appointments Portal \ud83d\udcd3",start:t,end:n,slot:[{reference:"Slot/".concat(a)}],participant:[{actor:{reference:"Patient/".concat(r)},status:"accepted"},{actor:{reference:"Location/".concat(s)},status:"accepted"}],extension:[{url:"https://fhir.nhs.uk/STU3/StructureDefinition/Extension-GPConnect-BookingOrganisation-1",valueReference:{reference:"#1"}}]}),c="urn:nhs:names:services:gpconnect:fhir:rest:create:appointment-1",i=Object(w.a)({},k,{"Ssp-InteractionID":c,Authorization:"Bearer ".concat(N())}),u="".concat(x,"/Appointment"),d.next=7,f.a.awrap(j({url:u,body:o,headers:i,method:"POST"}));case 7:return l=d.sent,d.abrupt("return",_(l));case 9:case"end":return d.stop()}}))},z=function(){return O(M)},B=function(){var e=Object(a.useState)([]),t=Object(g.a)(e,2),n=t[0],s=t[1],o=Object(a.useState)([]),c=Object(g.a)(o,2),i=c[0],u=c[1];return Object(a.useEffect)((function(){!function(){var e,t,n;f.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,f.a.awrap(P());case 2:e=a.sent,t=e.filter((function(e){return e.success})),n=e.filter((function(e){return!e.success})),s(t),u(n);case 7:case"end":return a.stop()}}))}()}),[]),r.a.createElement("div",{className:"mb4"},r.a.createElement("h2",{className:"mb2"},"Failed transfers"),r.a.createElement("div",{className:"mb2"},i.length," transfers failed."),r.a.createElement(v,{items:i,icon:!0,success:!1}),r.a.createElement("h2",{className:"mb2"},"Successful transfers"),r.a.createElement("div",{className:"mb2"},n.length," transfers successful."),r.a.createElement(v,{items:n,icon:!0}))},C=function(){var e,t;return f.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return e={},Object(b.a)(e,E,L),Object(b.a)(e,T,q),t=e,n.next=3,f.a.awrap(t[S()]());case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}}))},L=function(){var e,t,n;return f.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return"urn:nhs:names:services:gpconnect:fhir:rest:search:patient_appointments-1",e=Object(w.a)({},k,{"Ssp-InteractionID":"urn:nhs:names:services:gpconnect:fhir:rest:search:patient_appointments-1",Authorization:"Bearer ".concat(N())}),"2020-02-12","2020-02-22",t="".concat(x,"/Patient/2/Appointment?start=ge").concat("2020-02-12","&start=le").concat("2020-02-22"),a.next=7,f.a.awrap(j({url:t,headers:e,method:"GET"}));case 7:return n=a.sent,a.abrupt("return",_(n));case 9:case"end":return a.stop()}}))},q=function(){return O(G)},F=function(){var e=Object(a.useState)([]),t=Object(g.a)(e,2),n=t[0],s=t[1];return Object(a.useEffect)((function(){!function(){var e;f.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f.a.awrap(C());case 2:e=t.sent,s(e);case 4:case"end":return t.stop()}}))}()}),[]),r.a.createElement("div",{className:"mb4"},r.a.createElement("p",{className:"mb2"},"Found ",n.length," appointments in current solution between ",r.a.createElement("b",null,"today")," and ",r.a.createElement("b",null,"13/04/2020"),"."),r.a.createElement(c.b,{className:"nhsuk-link-override",to:"/".concat(i,"/booked")},r.a.createElement("button",{className:"nhsuk-button"},"Transfer all appointments")),r.a.createElement(v,{items:n}))},J=function(){return r.a.createElement(h.c,null,r.a.createElement(h.a,{exact:!0,path:"/".concat(i)},r.a.createElement(F,null)),r.a.createElement(h.a,{path:"/".concat(i,"/booked")},r.a.createElement(B,null)))},U=function(){var e;return e=Object(d.parse)(window.location.search,{parseBooleans:!0}),Object.entries(e).forEach((function(e){var t=Object(g.a)(e,2),n=t[0],a=t[1];y[n]=a})),r.a.createElement(a.Fragment,null,r.a.createElement(u,null),r.a.createElement("div",{className:p.a.content},r.a.createElement(J,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(53),n(54);o.a.render(r.a.createElement(c.a,null,r.a.createElement(U,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[27,1,2]]]);
//# sourceMappingURL=main.168dcb9a.chunk.js.map